(function(){$(function(){$(".header").load("header.html",function(){$(".header .nav a").removeClass("active").eq(5).addClass("active")});$(".footer").load("footer.html");var g=0;var f="";var b="";$.ajax({url:"ajax/selectArea.php",data:{},success:d});function d(k){var j='<a href="javascript:void(0)" data-id="0" class="active no" title="不限">不限</a>';for(var h=0;h<k.data.length;h++){j+='<a href="javascript:void(0)" title="海淀" data-id="'+k.data[h].id+'">'+k.data[h].name+"</a>"}$(".area").append(j);$(".area a").click(function(){g=0;$(".area a").removeClass("active");$(this).addClass("active");if($(this).is(".no")){f="";b="";$(".subarea").css("display","none")}else{$(".subarea").css("display","block");f=this.dataset.id;b="";$.ajax({url:"ajax/selectStreet.php",data:{aid:f},success:e})}$.ajax({url:"ajax/selectAgent.php",data:{pagenum:g,aid:f,sid:b},success:a})})}function e(k){var j='<a data-id="0" class="active no" href="javascript:void(0)" title="不限">不限</a>';for(var h=0;h<k.data.length;h++){j+='<a data-id="'+k.data[h].streetID+'" href="javascript:void(0)" title="'+k.data[h].streetName+'">'+k.data[h].streetName+"</a>"}$(".subarea").html(j);$(".subarea a").click(function(){g=0;$(".subarea a").removeClass("active");$(this).addClass("active");if($(this).is(".no")){b=""}else{b=this.dataset.id}$.ajax({url:"ajax/selectAgent.php",data:{pagenum:g,aid:f,sid:b},success:a})})}$.ajax({url:"ajax/selectAgent.php",data:{pagenum:0,aid:f,sid:b},success:a});function a(m){console.dir(m);var h="";for(var k=0;k<m.data.length;k++){h+='<li> <div class="pic"> <a href="agentdetail.html?id='+m.data[k].id+'"> <img src="ajax/upload/'+m.data[k].src+'" alt=""/> </a> </div> <div class="mid"> <h1>'+m.data[k].agentName+"</h1> <p>主营板块：<span>"+m.data[k].area+"</span>    <span>"+m.data[k].street+'</span> </p> <div class="phone">'+m.data[k].agentPhone+' </div> </div> <div class="btn"> <a href="agentdetail.html?id='+m.data[k].id+'">进入TA的店铺</a> </div> </li>'}$("ul.list").html(h);$(".total span").html(m.total);var l=Math.ceil(m.total/6);var j='<span class="disabled prev">上一页</span>';for(var k=0;k<l;k++){if(k==0){j+='<a href="javascript:void(0)" class="active">'+(k+1)+"</a>"}else{j+='<a href="javascript:void(0)">'+(k+1)+"</a>"}}j+='<span class="next">下一页</span>';$(".ctrl").html(j);$(".ctrl .prev").addClass("disabled");if(l<=1){$(".ctrl .next").addClass("disabled")}else{$(".ctrl .next").removeClass("disabled")}$(".ctrl a").click(function(){g=parseInt($(this).html())-1;if(l<=1){$(".ctrl .prev").addClass("disabled");$(".ctrl .next").addClass("disabled")}else{if(g<=0){$(".ctrl .prev").addClass("disabled");$(".ctrl .next").removeClass("disabled")}else{if(g>=l-1){$(".ctrl .prev").removeClass("disabled");$(".ctrl .next").addClass("disabled")}else{$(".ctrl .prev").removeClass("disabled");$(".ctrl .next").removeClass("disabled")}}}$(".ctrl a").removeClass("active");$(this).addClass("active");$.ajax({url:"ajax/selectAgent.php",data:{pagenum:g,aid:f,sid:b},success:c})})}function c(k){console.dir(k);var h="";for(var j=0;j<k.data.length;j++){h+='<li> <div class="pic"> <a href="agentdetail.html?id='+k.data[j].id+'"> <img src="ajax/upload/'+k.data[j].src+'" alt=""/> </a> </div> <div class="mid"> <h1>'+k.data[j].agentName+"</h1> <p>主营板块：<span>"+k.data[j].area+"</span>    <span>"+k.data[j].street+'</span> </p> <div class="phone">'+k.data[j].agentPhone+' </div> </div> <div class="btn"> <a href="agentdetail.html?id='+k.data[j].id+'">进入TA的店铺</a> </div> </li>'}$("ul.list").html(h)}})})();